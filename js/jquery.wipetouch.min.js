(function($){$.fn.wipetouch=function(settings){var config={moveX:40,moveY:40,tapToClick:false,preventDefault:true,allowDiagonal:false,wipeLeft:false,wipeRight:false,wipeUp:false,wipeDown:false,wipeUpLeft:false,wipeDownLeft:false,wipeUpRight:false,wipeDownRight:false,wipeMove:false,wipeTopLeft:false,wipeBottomLeft:false,wipeTopRight:false,wipeBottomRight:false};if(settings){$.extend(config,settings)}this.each(function(){var startX;var startY;var startDate=false;var curX;var curY;var isMoving=false;var touchedElement=false;var useMouseEvents=false;var clickEvent=false;function onTouchStart(e){var start=useMouseEvents||(e.originalEvent.touches&&e.originalEvent.touches.length>0);if(!isMoving&&start){if(config.preventDefault){e.preventDefault()}if(config.allowDiagonal){if(!config.wipeDownLeft){config.wipeDownLeft=config.wipeBottomLeft}if(!config.wipeDownRight){config.wipeDownRight=config.wipeBottomRight}if(!config.wipeUpLeft){config.wipeUpLeft=config.wipeTopLeft}if(!config.wipeUpRight){config.wipeUpRight=config.wipeTopRight}}if(useMouseEvents){startX=e.pageX;startY=e.pageY;$(this).bind("mousemove",onTouchMove);$(this).one("mouseup",onTouchEnd)}else{startX=e.originalEvent.touches[0].pageX;startY=e.originalEvent.touches[0].pageY;$(this).bind("touchmove",onTouchMove)}startDate=new Date().getTime();curX=startX;curY=startY;isMoving=true;touchedElement=$(e.target)}}function onTouchEnd(e){if(config.preventDefault){e.preventDefault()}if(useMouseEvents){$(this).unbind("mousemove",onTouchMove)}else{$(this).unbind("touchmove",onTouchMove)}if(isMoving){touchCalculate(e)}else{resetTouch()}}function onTouchMove(e){if(config.preventDefault){e.preventDefault()}if(useMouseEvents&&!isMoving){onTouchStart(e)}if(isMoving){if(useMouseEvents){curX=e.pageX;curY=e.pageY}else{curX=e.originalEvent.touches[0].pageX;curY=e.originalEvent.touches[0].pageY}if(config.wipeMove){triggerEvent(config.wipeMove,{curX:curX,curY:curY})}}}function touchCalculate(e){var endDate=new Date().getTime();var ms=startDate-endDate;var x=curX;var y=curY;var dx=x-startX;var dy=y-startY;var ax=Math.abs(dx);var ay=Math.abs(dy);if(ax<15&&ay<15&&ms<100){clickEvent=false;if(config.preventDefault){resetTouch();touchedElement.trigger("click");return}}else{if(useMouseEvents){var evts=touchedElement.data("events");if(evts){var clicks=evts.click;if(clicks&&clicks.length>0){$.each(clicks,function(i,f){clickEvent=f;return});touchedElement.unbind("click")}}}}var toright=dx>0;var tobottom=dy>0;var s=((ax+ay)*60)/((ms)/6*(ms));if(s<1){s=1}if(s>5){s=5}var result={speed:parseInt(s),x:ax,y:ay,source:touchedElement};if(ax>=config.moveX){if(config.allowDiagonal&&ay>=config.moveY){if(toright&&tobottom){triggerEvent(config.wipeDownRight,result)}else{if(toright&&!tobottom){triggerEvent(config.wipeUpRight,result)}else{if(!toright&&tobottom){triggerEvent(config.wipeDownLeft,result)}else{triggerEvent(config.wipeUpLeft,result)}}}}else{if(ax>=ay){if(toright){triggerEvent(config.wipeRight,result)}else{triggerEvent(config.wipeLeft,result)}}}}else{if(ay>=config.moveY&&ay>ax){if(tobottom){triggerEvent(config.wipeDown,result)}else{triggerEvent(config.wipeUp,result)}}}resetTouch()}function resetTouch(){startX=false;startY=false;startDate=false;isMoving=false;if(clickEvent){window.setTimeout(function(){touchedElement.bind("click",clickEvent);clickEvent=false},50)}}function triggerEvent(wipeEvent,result){if(wipeEvent){wipeEvent(result)}}if("ontouchstart" in document.documentElement){$(this).bind("touchstart",onTouchStart);$(this).bind("touchend",onTouchEnd)}else{useMouseEvents=true;$(this).bind("mousedown",onTouchStart);$(this).bind("mouseout",onTouchEnd)}});return this}})(jQuery);